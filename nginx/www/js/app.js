(function(e){function t(t){for(var r,o,l=t[0],s=t[1],u=t[2],h=0,f=[];h<l.length;h++)o=l[h],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);c&&c(t);while(f.length)f.shift()();return n.push.apply(n,u||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],r=!0,l=1;l<a.length;l++){var s=a[l];0!==i[s]&&(r=!1)}r&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},i={app:0},n=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=s;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0431":function(e,t,a){"use strict";var r=a("f76b"),i=a.n(r);i.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),i=a("5c96"),n=a.n(i),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("player")],1)},l=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"player"}},[a("el-main",[a("el-row",[a("el-col",{attrs:{lg:{span:12,offset:6},md:{span:16,offset:4}}},[a("el-tabs",{attrs:{value:e.defaultTab},on:{"tab-click":e.handleClick}},e._l(e.tabs,(function(e,t){return a("el-tab-pane",{key:t,attrs:{name:t,label:e.name}})})),1),e.tabs[e.currentTab]||e.tabs[e.defaultTab]?a(e.tabs[e.currentTab]||e.tabs[e.defaultTab],{tag:"component"}):e._e()],1)],1)],1)],1)},u=[],c=(a("7f7f"),a("ac6a"),a("456d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"flv-js-player"}},[a("el-form",{attrs:{model:e.mediaDataSource,disabled:!e.supported},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{model:{value:e.mediaDataSource.url,callback:function(t){e.$set(e.mediaDataSource,"url",t)},expression:"mediaDataSource.url"}})],1),a("el-form-item",[a("el-checkbox",{attrs:{label:"isLive"},model:{value:e.mediaDataSource.isLive,callback:function(t){e.$set(e.mediaDataSource,"isLive",t)},expression:"mediaDataSource.isLive"}}),a("el-checkbox",{attrs:{label:"hasAudio"},model:{value:e.mediaDataSource.hasAudio,callback:function(t){e.$set(e.mediaDataSource,"hasAudio",t)},expression:"mediaDataSource.hasAudio"}}),a("el-checkbox",{attrs:{label:"hasVideo"},model:{value:e.mediaDataSource.hasVideo,callback:function(t){e.$set(e.mediaDataSource,"hasVideo",t)},expression:"mediaDataSource.hasVideo"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.load}},[e._v("LOAD")]),a("el-button",{attrs:{size:"mini"},on:{click:e.start}},[e._v("START")]),a("el-button",{attrs:{size:"mini"},on:{click:e.pause}},[e._v("PAUSE")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.destroy}},[e._v("DESTROY")])],1),a("el-form-item",[e._v("\n      Current buffer length: "+e._s(e.poorestHealth.toFixed(3))+"s\n    ")])],1),a("video",e._b({ref:"video",on:{timeupdate:e.onTimeUpdate}},"video",e.mappedMediaDataSource.isLive?{}:{controls:""},!1))],1)}),h=[],f=(a("8e6e"),a("75fc")),p=a("bd86"),d=a("1947");function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){Object(p["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={name:"flv-js",watch:{"mediaDataSource.url":function(e){try{localStorage.setItem("flv-js.mediaDataSource.url",e)}catch(t){console.log(t)}}},methods:{loadLocalMediaDataSource:function(){try{var e=localStorage.getItem("flv-js.mediaDataSource.url");null!==e&&(this.mediaDataSource.url=e)}catch(t){console.log(t)}},load:function(){this.bufferHealth=[],this.playbackRate=1,this.player&&this.destroy(),this.player=d["a"].createPlayer(m({},this.mappedMediaDataSource)),this.player.attachMediaElement(this.$refs.video),this.player.load(),this.bindEvents()},bindEvents:function(){this.player.on("error",this.destroy),this.player.on("statistics_info",(function(){}))},start:function(){this.player&&this.player.play()},pause:function(){this.player&&this.player.pause()},destroy:function(){this.player&&(this.player.pause(),this.player.unload(),this.player.detachMediaElement(),this.player.destroy(),this.player=null)},onTimeUpdate:function(){if(this.mappedMediaDataSource.isLive){var e=this.$refs.video;if(e&&!e.paused&&e.buffered&&0!==e.buffered.length){var t,a=e.currentTime,r=e.buffered.end(e.buffered.length-1),i=r-a,n=Math.floor(Date.now()/500);this.bufferHealth.length&&this.bufferHealth[this.bufferHealth.length-1].periodId===n?t=this.bufferHealth[this.bufferHealth.length-1]:(t={periodId:n,min:i},this.bufferHealth.push(t)),t.min=Math.min(t.min,i),this.bufferHealth.length>this.bufferHealthRecordSize&&this.bufferHealth.shift(),this.bufferHealth.length<this.bufferHealthRecordSize||(this.poorestHealth>2*this.bufferHealthHighWaterMark?e.currentTime=e.currentTime+(this.poorestHealth-this.bufferHealthTarget):this.poorestHealth>this.bufferHealthHighWaterMark?1===this.playbackRate&&(this.playbackRate=e.playbackRate=1.05):this.poorestHealth<this.bufferHealthTarget&&this.playbackRate>1&&(this.playbackRate=e.playbackRate=1))}}}},data:function(){var e=location.protocol+"//"+location.hostname+":"+location.port;return{supported:!1,player:null,mediaDataSource:{type:"flv",isLive:!0,url:e+"/live?app=demo&stream=stream-1",hasAudio:!0,hasVideo:!0},bufferHealthRecordSize:10,bufferHealth:[],bufferHealthHighWaterMark:1.6,bufferHealthTarget:.8,playbackRate:1}},computed:{mappedMediaDataSource:function(){return m({},this.mediaDataSource,{},this.mediaDataSource.isLive?{enableStashBuffer:!1,stashInitialSize:128,enableWorker:!0}:{})},poorestHealth:function(){return Math.min.apply(Math,Object(f["a"])(this.bufferHealth.map((function(e){return e.min}))))}},mounted:function(){this.supported=d["a"].isSupported(),this.loadLocalMediaDataSource()},beforeDestroy:function(){this.destroy()}},v=y,g=(a("0431"),a("2877")),S=Object(g["a"])(v,c,h,!1,null,null,null),H=S.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"flv-js-player"}},[a("el-form",{attrs:{model:e.mediaDataSource,disabled:!e.supported},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{model:{value:e.mediaDataSource.url,callback:function(t){e.$set(e.mediaDataSource,"url",t)},expression:"mediaDataSource.url"}})],1),a("el-form-item",[a("el-checkbox",{attrs:{label:"isLive"},model:{value:e.mediaDataSource.isLive,callback:function(t){e.$set(e.mediaDataSource,"isLive",t)},expression:"mediaDataSource.isLive"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.load}},[e._v("LOAD")]),a("el-button",{attrs:{size:"mini"},on:{click:e.start}},[e._v("START")]),a("el-button",{attrs:{size:"mini"},on:{click:e.pause}},[e._v("PAUSE")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.destroy}},[e._v("DESTROY")])],1),a("el-form-item",[e._v("\n      Poorest buffer length: "+e._s(e.poorestHealth.toFixed(3))+"s "),a("br"),e._v("\n      Average buffer length: "+e._s(e.averageHealth.toFixed(3))+"s "),a("br"),e._v("\n      Best buffer length: "+e._s(e.bestHealth.toFixed(3))+"s "),a("br"),e._v("\n      Playback Rate: "+e._s(e.playbackRate)+"\n    ")])],1),a("video",e._b({ref:"video",on:{timeupdate:e.onTimeUpdate}},"video",e.mappedMediaDataSource.isLive?{}:{controls:""},!1))],1)},k=[],O=(a("55dd"),a("ba56")),j=a.n(O);function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){Object(p["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={name:"hls-js",watch:{"mediaDataSource.url":function(e){try{localStorage.setItem("hls-js.mediaDataSource.url",e)}catch(t){console.log(t)}}},methods:{loadLocalMediaDataSource:function(){try{var e=localStorage.getItem("hls-js.mediaDataSource.url");null!==e&&(this.mediaDataSource.url=e)}catch(t){console.log(t)}},load:function(){this.bufferHealth=[],this.playbackRate=1,this.hls&&this.destroy(),this.hls=new j.a(this.mediaDataSource.config),this.hls.loadSource(this.mediaDataSource.url),this.hls.attachMedia(this.$refs.video),this.player=this.$refs.video,this.bindEvents()},bindEvents:function(){this.hls.on(j.a.Events.MANIFEST_PARSED,(function(e){console.log(e)}))},start:function(){console.log(this.player),this.player&&this.player.play()},pause:function(){console.log(this.player),this.player&&this.player.pause()},destroy:function(){this.hls&&(this.player.pause(),this.hls.detachMedia(),this.hls.destroy(),this.hls=null)},onTimeUpdate:function(){if(this.mappedMediaDataSource.isLive){var e=this.$refs.video;if(e&&!e.paused&&e.buffered&&0!==e.buffered.length){var t,a=e.currentTime,r=e.buffered.end(e.buffered.length-1),i=r-a,n=Math.floor(Date.now()/500);this.bufferHealth.length&&this.bufferHealth[this.bufferHealth.length-1].periodId===n?t=this.bufferHealth[this.bufferHealth.length-1]:(t={periodId:n,min:i,max:i},this.bufferHealth.push(t)),t.min=Math.min(t.min,i),t.max=Math.min(t.max,i),this.bufferHealth.length>this.bufferHealthRecordSize&&this.bufferHealth.shift(),this.bufferHealth.length<this.bufferHealthRecordSize||(this.averageHealth>2*this.bufferHealthHighWaterMark?(e.currentTime=e.currentTime+(this.poorestHealth-this.bufferHealthTarget),this.bufferHealth=[],this.playbackRate=e.playbackRate=1):this.averageHealth>this.bufferHealthHighWaterMark?this.playbackRate<=1&&(this.playbackRate=e.playbackRate=1.02):this.averageHealth<this.bufferHealthLowWaterMark?this.playbackRate>=1&&(this.playbackRate=e.playbackRate=.98):(this.averageHealth<this.bufferHealthHighZone&&this.playbackRate>1||this.averageHealth>this.bufferHealthLowZone&&this.playbackRate<1)&&(this.playbackRate=e.playbackRate=1))}}}},data:function(){var e=location.protocol+"//"+location.hostname+":"+location.port;return{supported:!1,hls:null,player:null,mediaDataSource:{config:{liveSyncDurationCount:1},isLive:!0,url:e+"/hls/stream-1.m3u8"},bufferHealthRecordSize:10,bufferHealth:[],bufferHealthLowWaterMark:1.2,bufferHealthLowZone:1.4,bufferHealthTarget:1.7,bufferHealthHighZone:1.9,bufferHealthHighWaterMark:2.1,playbackRate:1}},computed:{mappedMediaDataSource:function(){return _({},this.mediaDataSource)},poorestHealth:function(){return Math.min.apply(Math,Object(f["a"])(this.bufferHealth.map((function(e){return e.min}))))},averageHealth:function(){var e=this.bufferHealth.map((function(e){return(e.min+e.max)/2}));return e.sort((function(e,t){return e-t})),e.pop(),e.shift(),e.reduce((function(e,t){return e+t}),0)/Math.max(e.length,1)},bestHealth:function(){return Math.max.apply(Math,Object(f["a"])(this.bufferHealth.map((function(e){return e.max}))))}},mounted:function(){this.supported=j.a.isSupported(),this.loadLocalMediaDataSource()},beforeDestroy:function(){this.destroy()}},w=R,T=(a("f3ea"),Object(g["a"])(w,D,k,!1,null,null,null)),x=T.exports,P={name:"player",components:{FlvJs:H,HlsJs:x},computed:{defaultTab:function(){return Object.keys(this.tabs).length?Object.keys(this.tabs)[0]:null}},methods:{handleClick:function(e){this.currentTab=e.name}},data:function(){return{tabs:{FlvJs:H,HlsJs:x},currentTab:null}}},L=P,E=Object(g["a"])(L,s,u,!1,null,null,null),$=E.exports,z={name:"app",components:{Player:$}},A=z,I=(a("5c0b"),Object(g["a"])(A,o,l,!1,null,null,null)),W=I.exports;a("a41b");r["default"].config.productionTip=!0,r["default"].use(n.a),new r["default"]({render:function(e){return e(W)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var r=a("e332"),i=a.n(r);i.a},a41b:function(e,t,a){},e332:function(e,t,a){},e8f6:function(e,t,a){},f3ea:function(e,t,a){"use strict";var r=a("e8f6"),i=a.n(r);i.a},f76b:function(e,t,a){}});
//# sourceMappingURL=app.js.map